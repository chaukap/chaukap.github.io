<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_kyxw7dufnrka-7{list-style-type:none}ul.lst-kix_kyxw7dufnrka-6{list-style-type:none}ul.lst-kix_kyxw7dufnrka-5{list-style-type:none}ul.lst-kix_kyxw7dufnrka-4{list-style-type:none}ul.lst-kix_kyxw7dufnrka-8{list-style-type:none}.lst-kix_n8ifosv3pzjr-5>li:before{content:"\0025a0  "}ul.lst-kix_kyxw7dufnrka-3{list-style-type:none}ul.lst-kix_kyxw7dufnrka-2{list-style-type:none}ul.lst-kix_kyxw7dufnrka-1{list-style-type:none}.lst-kix_n8ifosv3pzjr-4>li:before{content:"\0025cb  "}ul.lst-kix_kyxw7dufnrka-0{list-style-type:none}ul.lst-kix_merlioigqv7p-6{list-style-type:none}.lst-kix_tx42ui3t8aq-4>li:before{content:"\0025cb  "}ul.lst-kix_merlioigqv7p-5{list-style-type:none}ul.lst-kix_merlioigqv7p-8{list-style-type:none}.lst-kix_n8ifosv3pzjr-6>li:before{content:"\0025cf  "}ul.lst-kix_merlioigqv7p-7{list-style-type:none}ul.lst-kix_merlioigqv7p-2{list-style-type:none}.lst-kix_tx42ui3t8aq-2>li:before{content:"\0025a0  "}.lst-kix_tx42ui3t8aq-3>li:before{content:"\0025cf  "}ul.lst-kix_merlioigqv7p-1{list-style-type:none}ul.lst-kix_merlioigqv7p-4{list-style-type:none}.lst-kix_n8ifosv3pzjr-7>li:before{content:"\0025cb  "}ul.lst-kix_merlioigqv7p-3{list-style-type:none}.lst-kix_tx42ui3t8aq-1>li:before{content:"\0025cb  "}ul.lst-kix_merlioigqv7p-0{list-style-type:none}.lst-kix_n8ifosv3pzjr-8>li:before{content:"\0025a0  "}.lst-kix_8av0gt2sbrls-2>li:before{content:"\0025a0  "}ul.lst-kix_jg497om68o4j-8{list-style-type:none}ul.lst-kix_jg497om68o4j-7{list-style-type:none}ul.lst-kix_jg497om68o4j-6{list-style-type:none}.lst-kix_jg497om68o4j-3>li:before{content:"\0025cf  "}.lst-kix_jg497om68o4j-5>li:before{content:"\0025a0  "}ul.lst-kix_jg497om68o4j-5{list-style-type:none}ul.lst-kix_jg497om68o4j-4{list-style-type:none}.lst-kix_tx42ui3t8aq-0>li:before{content:"\0025cf  "}ul.lst-kix_jg497om68o4j-3{list-style-type:none}.lst-kix_4n4zmp7ec4bg-1>li:before{content:"\0025cb  "}ul.lst-kix_vdruwm8aalul-8{list-style-type:none}.lst-kix_8av0gt2sbrls-3>li:before{content:"\0025cf  "}ul.lst-kix_jg497om68o4j-2{list-style-type:none}ul.lst-kix_vdruwm8aalul-7{list-style-type:none}ul.lst-kix_jg497om68o4j-1{list-style-type:none}.lst-kix_jg497om68o4j-4>li:before{content:"\0025cb  "}.lst-kix_jg497om68o4j-8>li:before{content:"\0025a0  "}ul.lst-kix_vdruwm8aalul-6{list-style-type:none}ul.lst-kix_vdruwm8aalul-5{list-style-type:none}ul.lst-kix_vdruwm8aalul-4{list-style-type:none}ul.lst-kix_vdruwm8aalul-3{list-style-type:none}.lst-kix_jg497om68o4j-7>li:before{content:"\0025cb  "}.lst-kix_4n4zmp7ec4bg-0>li:before{content:"\0025cf  "}ul.lst-kix_vdruwm8aalul-2{list-style-type:none}.lst-kix_8av0gt2sbrls-0>li:before{content:"\0025cf  "}ul.lst-kix_vdruwm8aalul-1{list-style-type:none}ul.lst-kix_vdruwm8aalul-0{list-style-type:none}.lst-kix_8av0gt2sbrls-1>li:before{content:"\0025cb  "}.lst-kix_jg497om68o4j-6>li:before{content:"\0025cf  "}ul.lst-kix_jg497om68o4j-0{list-style-type:none}.lst-kix_vdruwm8aalul-8>li:before{content:"\0025a0  "}.lst-kix_vdruwm8aalul-6>li:before{content:"\0025cf  "}.lst-kix_vdruwm8aalul-7>li:before{content:"\0025cb  "}ul.lst-kix_8av0gt2sbrls-1{list-style-type:none}ul.lst-kix_8av0gt2sbrls-2{list-style-type:none}ul.lst-kix_8av0gt2sbrls-3{list-style-type:none}ul.lst-kix_8av0gt2sbrls-4{list-style-type:none}ul.lst-kix_8av0gt2sbrls-5{list-style-type:none}ul.lst-kix_8av0gt2sbrls-6{list-style-type:none}ul.lst-kix_8av0gt2sbrls-7{list-style-type:none}ul.lst-kix_8av0gt2sbrls-8{list-style-type:none}ul.lst-kix_tx42ui3t8aq-8{list-style-type:none}ul.lst-kix_8av0gt2sbrls-0{list-style-type:none}.lst-kix_kyxw7dufnrka-0>li:before{content:"\0025cf  "}.lst-kix_kyxw7dufnrka-1>li:before{content:"\0025cb  "}.lst-kix_e9hchp1s10m3-3>li:before{content:"\0025cf  "}.lst-kix_e9hchp1s10m3-4>li:before{content:"\0025cb  "}.lst-kix_kyxw7dufnrka-3>li:before{content:"\0025cf  "}.lst-kix_e9hchp1s10m3-1>li:before{content:"\0025cb  "}.lst-kix_e9hchp1s10m3-5>li:before{content:"\0025a0  "}.lst-kix_e9hchp1s10m3-0>li:before{content:"\0025cf  "}.lst-kix_e9hchp1s10m3-7>li:before{content:"\0025cb  "}.lst-kix_e9hchp1s10m3-8>li:before{content:"\0025a0  "}.lst-kix_tx42ui3t8aq-5>li:before{content:"\0025a0  "}.lst-kix_kyxw7dufnrka-2>li:before{content:"\0025a0  "}.lst-kix_e9hchp1s10m3-6>li:before{content:"\0025cf  "}.lst-kix_vdruwm8aalul-1>li:before{content:"\0025cb  "}.lst-kix_tx42ui3t8aq-6>li:before{content:"\0025cf  "}.lst-kix_tx42ui3t8aq-7>li:before{content:"\0025cb  "}.lst-kix_vdruwm8aalul-0>li:before{content:"\0025cf  "}.lst-kix_vdruwm8aalul-2>li:before{content:"\0025a0  "}.lst-kix_n8ifosv3pzjr-1>li:before{content:"\0025cb  "}.lst-kix_n8ifosv3pzjr-3>li:before{content:"\0025cf  "}ul.lst-kix_e9hchp1s10m3-1{list-style-type:none}.lst-kix_tx42ui3t8aq-8>li:before{content:"\0025a0  "}ul.lst-kix_e9hchp1s10m3-2{list-style-type:none}.lst-kix_n8ifosv3pzjr-2>li:before{content:"\0025a0  "}ul.lst-kix_e9hchp1s10m3-0{list-style-type:none}.lst-kix_vdruwm8aalul-5>li:before{content:"\0025a0  "}.lst-kix_vdruwm8aalul-4>li:before{content:"\0025cb  "}.lst-kix_vdruwm8aalul-3>li:before{content:"\0025cf  "}.lst-kix_e9hchp1s10m3-2>li:before{content:"\0025a0  "}.lst-kix_n8ifosv3pzjr-0>li:before{content:"\0025cf  "}ul.lst-kix_n8ifosv3pzjr-0{list-style-type:none}ul.lst-kix_n8ifosv3pzjr-1{list-style-type:none}ul.lst-kix_n8ifosv3pzjr-2{list-style-type:none}ul.lst-kix_n8ifosv3pzjr-3{list-style-type:none}ul.lst-kix_4sf05wihiihr-8{list-style-type:none}ul.lst-kix_n8ifosv3pzjr-4{list-style-type:none}ul.lst-kix_4sf05wihiihr-7{list-style-type:none}ul.lst-kix_n8ifosv3pzjr-5{list-style-type:none}ul.lst-kix_4sf05wihiihr-6{list-style-type:none}ul.lst-kix_n8ifosv3pzjr-6{list-style-type:none}ul.lst-kix_4sf05wihiihr-5{list-style-type:none}ul.lst-kix_4sf05wihiihr-4{list-style-type:none}ul.lst-kix_e9hchp1s10m3-5{list-style-type:none}ul.lst-kix_4sf05wihiihr-3{list-style-type:none}ul.lst-kix_e9hchp1s10m3-6{list-style-type:none}ul.lst-kix_4sf05wihiihr-2{list-style-type:none}ul.lst-kix_e9hchp1s10m3-3{list-style-type:none}ul.lst-kix_4sf05wihiihr-1{list-style-type:none}ul.lst-kix_e9hchp1s10m3-4{list-style-type:none}ul.lst-kix_4sf05wihiihr-0{list-style-type:none}ul.lst-kix_e9hchp1s10m3-7{list-style-type:none}ul.lst-kix_e9hchp1s10m3-8{list-style-type:none}.lst-kix_kyxw7dufnrka-8>li:before{content:"\0025a0  "}.lst-kix_merlioigqv7p-1>li:before{content:"\0025cb  "}ul.lst-kix_4n4zmp7ec4bg-1{list-style-type:none}ul.lst-kix_4n4zmp7ec4bg-0{list-style-type:none}.lst-kix_kyxw7dufnrka-7>li:before{content:"\0025cb  "}.lst-kix_merlioigqv7p-0>li:before{content:"\0025cf  "}.lst-kix_merlioigqv7p-4>li:before{content:"\0025cb  "}ul.lst-kix_4n4zmp7ec4bg-5{list-style-type:none}.lst-kix_kyxw7dufnrka-4>li:before{content:"\0025cb  "}ul.lst-kix_4n4zmp7ec4bg-4{list-style-type:none}ul.lst-kix_4n4zmp7ec4bg-3{list-style-type:none}.lst-kix_merlioigqv7p-3>li:before{content:"\0025cf  "}ul.lst-kix_4n4zmp7ec4bg-2{list-style-type:none}.lst-kix_kyxw7dufnrka-6>li:before{content:"\0025cf  "}ul.lst-kix_4n4zmp7ec4bg-8{list-style-type:none}.lst-kix_kyxw7dufnrka-5>li:before{content:"\0025a0  "}ul.lst-kix_4n4zmp7ec4bg-7{list-style-type:none}.lst-kix_merlioigqv7p-2>li:before{content:"\0025a0  "}ul.lst-kix_4n4zmp7ec4bg-6{list-style-type:none}ul.lst-kix_tx42ui3t8aq-7{list-style-type:none}ul.lst-kix_tx42ui3t8aq-6{list-style-type:none}ul.lst-kix_tx42ui3t8aq-5{list-style-type:none}ul.lst-kix_tx42ui3t8aq-4{list-style-type:none}.lst-kix_merlioigqv7p-7>li:before{content:"\0025cb  "}ul.lst-kix_tx42ui3t8aq-3{list-style-type:none}ul.lst-kix_tx42ui3t8aq-2{list-style-type:none}ul.lst-kix_tx42ui3t8aq-1{list-style-type:none}ul.lst-kix_tx42ui3t8aq-0{list-style-type:none}.lst-kix_merlioigqv7p-8>li:before{content:"\0025a0  "}.lst-kix_merlioigqv7p-5>li:before{content:"\0025a0  "}.lst-kix_merlioigqv7p-6>li:before{content:"\0025cf  "}.lst-kix_4sf05wihiihr-4>li:before{content:"\0025cb  "}.lst-kix_4sf05wihiihr-3>li:before{content:"\0025cf  "}.lst-kix_4sf05wihiihr-5>li:before{content:"\0025a0  "}.lst-kix_4sf05wihiihr-2>li:before{content:"\0025a0  "}.lst-kix_4sf05wihiihr-6>li:before{content:"\0025cf  "}.lst-kix_4n4zmp7ec4bg-8>li:before{content:"\0025a0  "}.lst-kix_4n4zmp7ec4bg-7>li:before{content:"\0025cb  "}.lst-kix_4n4zmp7ec4bg-6>li:before{content:"\0025cf  "}.lst-kix_4n4zmp7ec4bg-5>li:before{content:"\0025a0  "}.lst-kix_8av0gt2sbrls-7>li:before{content:"\0025cb  "}.lst-kix_jg497om68o4j-0>li:before{content:"\0025cf  "}.lst-kix_4n4zmp7ec4bg-2>li:before{content:"\0025a0  "}.lst-kix_4sf05wihiihr-8>li:before{content:"\0025a0  "}.lst-kix_8av0gt2sbrls-6>li:before{content:"\0025cf  "}.lst-kix_4sf05wihiihr-7>li:before{content:"\0025cb  "}.lst-kix_jg497om68o4j-1>li:before{content:"\0025cb  "}.lst-kix_4n4zmp7ec4bg-4>li:before{content:"\0025cb  "}.lst-kix_8av0gt2sbrls-4>li:before{content:"\0025cb  "}.lst-kix_4n4zmp7ec4bg-3>li:before{content:"\0025cf  "}.lst-kix_8av0gt2sbrls-5>li:before{content:"\0025a0  "}.lst-kix_jg497om68o4j-2>li:before{content:"\0025a0  "}.lst-kix_8av0gt2sbrls-8>li:before{content:"\0025a0  "}ul.lst-kix_n8ifosv3pzjr-7{list-style-type:none}.lst-kix_4sf05wihiihr-0>li:before{content:"\0025cf  "}ul.lst-kix_n8ifosv3pzjr-8{list-style-type:none}.lst-kix_4sf05wihiihr-1>li:before{content:"\0025cb  "}ol{margin:0;padding:0}table td,table th{padding:0}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c5{padding-top:20pt;padding-bottom:6pt;line-height:2.0;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c12{padding-top:0pt;padding-bottom:12pt;line-height:2.0;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c7{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Arial";font-style:normal}.c9{padding-top:0pt;padding-bottom:16pt;line-height:2.0;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c13{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c11{padding-top:0pt;padding-bottom:0pt;line-height:2.0;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c4{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c10{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c6{color:inherit;text-decoration:inherit}.c8{font-style:italic}.c3{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c10"><p class="c12 title" id="h.tpch87byqqgr"><span class="c13">Automating Helmet Compliance at Ski Resorts</span></p><p class="c9 subtitle" id="h.ccsr5zxssf2i"><span>David Ristau, Courtney Smith, Grant Wilson, and Chandler Haukap</span></p><p class="c0"><span class="c1">Github: </span></p><p class="c0"><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://github.com/courtney-smith-97/w251_final&amp;sa=D&amp;source=editors&amp;ust=1650476739426848&amp;usg=AOvVaw0piu44bHaKnwX9K_DKazLu">https://github.com/courtney-smith-97/w251_final</a></span><span class="c1">&nbsp;</span></p><p class="c0"><span>Data: </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://drive.google.com/file/d/1uVFT3pbONUImLhz149Nbe3cS7pgZS4-W/view?usp%3Dsharing&amp;sa=D&amp;source=editors&amp;ust=1650476739427346&amp;usg=AOvVaw358mY7jiEs10YEUAb5zfZS">https://drive.google.com/file/d/1uVFT3pbONUImLhz149Nbe3cS7pgZS4-W/view?usp=sharing</a></span><span class="c1">&nbsp;</span></p><p class="c0"><span>S3 Bucket: </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://s3.console.aws.amazon.com/s3/buckets/w251spr2022-final-project?region%3Dus-east-1%26tab%3Dobjects&amp;sa=D&amp;source=editors&amp;ust=1650476739427780&amp;usg=AOvVaw2Rwm07w7yXlPoHISNXo9Yy">https://s3.console.aws.amazon.com/s3/buckets/w251spr2022-final-project?region=us-east-1&amp;tab=objects</a></span><span class="c1">&nbsp;</span></p><h1 class="c5" id="h.2ctxshyxdmkm"><span>O</span><span>verview</span></h1><p class="c0"><span>Skiing and snowboarding are extremely popular sports both globally and domestically, with 462 ski resorts operating in the United States alone in 2021 (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://nsaa.org/webdocs/Media_Public/IndustryStats/ski_areas_by_state_thru_2021.pdf&amp;sa=D&amp;source=editors&amp;ust=1650476739428399&amp;usg=AOvVaw0mg1tS0A5qjLY-h7EgoA30">NSAA 2022</a></span><span>). </span><span>The subsidiaries of Vail Resorts alone reported a net income of 127.9 million dollars in the fiscal year 2021 (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://investors.vailresorts.com/news-releases/news-release-details/vail-resorts-reports-fiscal-2021-fourth-quarter-and-full-year&amp;sa=D&amp;source=editors&amp;ust=1650476739428774&amp;usg=AOvVaw3KbTPdVuuy8N5HzBg5a8BY">Vail Resorts 2022</a></span><span>).</span><span class="c1">&nbsp;These figures are expected to grow as COVID-19 lockdown restrictions and visitor limits are lifted.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span>Increased visitor counts also increase the risk of injuries as trails and lifts get more crowded and trail conditions deteriorate. Proper equipment is paramount in preventing injuries. The US Consumer Product Safety Commission found that around 50% of head injuries could be prevented by the use of a helmet. Although several countries have mandated helmet use for children, and several US states have considered mandatory helmet legislation, the majority of US ski resorts do not currently mandate helmets for children or adults; this may be partially due to difficulties around monitoring helmet usage or enforcing compliance. (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3989528/&amp;sa=D&amp;source=editors&amp;ust=1650476739429357&amp;usg=AOvVaw16b44qzSZ5qdzj0Lb5bLLJ">Haider, Saleem, Bilaniuk, and Barraco 2014</a></span><span class="c1">). We believe that an automated system that detects helmets could make compliance easier to enforce. Additionally, the system will give a more accurate view of the rates of helmet usage for skiers and snowboarders.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">Leveraging existing deep learning frameworks, our group was able to design a helmet detection system that can be deployed on edge devices for use at ski resorts. </span></p><h1 class="c5" id="h.rkkf4iczu18s"><span>Data</span></h1><p class="c0"><span class="c1">Unfortunately, we could not locate a pre-labeled dataset of ski helmets. However, there are multiple datasets that contain skiing images. By aggregating images of skis, we were able to locate well over 1,000 examples of helmet compliance and non-compliance. </span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span>The ski images we used came from the Common Objects in Context (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://cocodataset.org/%23explore&amp;sa=D&amp;source=editors&amp;ust=1650476739430273&amp;usg=AOvVaw02Un5tpyzVmLWmVlXC7SFS">COCO</a></span><span class="c1">) dataset. COCO was created by a team of researchers both from academia and private companies. The dataset itself contains over 150,000 images. We selected COCO because we could easily filter the dataset down to the 6,887 images labeled &ldquo;ski&rdquo;. Not all of these images were helpful. Some were too blurry to tell if the wearer of the skis was wearing a helmet. Others contained no human at all or only an image of their legs.</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 299.09px; height: 258.22px;"><img alt="" src="images/image10.png" style="width: 299.09px; height: 586.04px; margin-left: 0.00px; margin-top: -150.17px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 312.73px; height: 210.42px;"><img alt="" src="images/image8.png" style="width: 340.77px; height: 657.98px; margin-left: -15.10px; margin-top: -225.49px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">Fortunately, we were able to repurpose 3,262 images that contained not only the skis but also the head of the human wearing them. </span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 299.58px; height: 229.58px;"><img alt="" src="images/image12.png" style="width: 299.58px; height: 586.17px; margin-left: 0.00px; margin-top: -179.52px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 310.97px; height: 322.86px;"><img alt="" src="images/image4.png" style="width: 310.97px; height: 606.55px; margin-left: 0.00px; margin-top: -140.90px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span>Labeling the images was performed by hand. We used Roboflow&rsquo;s interface to draw the bounding boxes and filter unusable images (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://roboflow.com/&amp;sa=D&amp;source=editors&amp;ust=1650476739431327&amp;usg=AOvVaw1gRfKWOaURmKOS5uy1LpRY">Roboflow</a></span><span class="c1">). There was some debate on whether we should label compliance, i.e. helmets, noncompliance, i.e. bare heads, Or both. We decided to label both. Our decision was based on the fact that the two labels are mutually exclusive. Receiving a label of noncompliance does not impact the model&rsquo;s decision to also label the image compliant. In this way, we are able to train two image classifiers at once: one that detects bare heads and one that detects helmets. If this model were deployed at a ski resort the operators would be able to choose the most performant label or some combination of the two labels at their discretion.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">In addition, generating results of both positive and negative examples would make iterating on the model much easier in the future.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 299.58px; height: 300.50px;"><img alt="" src="images/image5.png" style="width: 299.58px; height: 300.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 300.59px; height: 294.86px;"><img alt="" src="images/image7.png" style="width: 300.59px; height: 294.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">From the 3,262 images, we annotated 2,374 examples of noncompliance and 1,605 examples of helmet use. On average each image contained 1.2 annotations with some images providing more than 6 unique examples. The number of annotations per image is visualized below:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 421.50px; height: 270.22px;"><img alt="" src="images/image2.png" style="width: 421.50px; height: 270.22px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">We augmented the data with a horizontal flip that gave us a total of 4,966 images. These images were divided into train/set sets using an 80/20 split for a total of 3,968 training images, 638 validation images, and 360 test images.</span></p><h1 class="c5" id="h.bo2ezkxope5v"><span>Tools and Data Pipeline</span></h1><p class="c0"><span class="c1">To develop this application multiple tools were used in the training pipeline as well as at inference time.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span>As mentioned previously, the data source for this project was the COCO dataset. We then applied custom labels, &lsquo;helmet&rsquo; and &lsquo;no helmet&rsquo; to our dataset using Roboflow. Roboflow was a key tool in the model training and iteration phase. Alternative labeling tools that were considered were </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://github.com/ivangrov/ModifiedOpenLabelling&amp;sa=D&amp;source=editors&amp;ust=1650476739433279&amp;usg=AOvVaw0aRjytMJFRidze5SXSDhAG">Open Labeling</a></span><span>, </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://www.makesense.ai&amp;sa=D&amp;source=editors&amp;ust=1650476739433516&amp;usg=AOvVaw3KPhcmBghbt3ZGbi1cYVMI">Make Sense AI</a></span><span>, and </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://docs.aws.amazon.com/sagemaker/latest/dg/sms.html&amp;sa=D&amp;source=editors&amp;ust=1650476739433779&amp;usg=AOvVaw0j_PVQYoG4bYh0C_SwC6DN">AWS sagemaker ground truth</a></span><span class="c1">. Open labeling and Make Sense AI do not include the ability to manage a dataset or distribute labeling amongst multiple team members. AWS ground truth and Roboflow enable labeling to be distributed amongst multiple team members, however AWS ground truth is more limited in dataset management as well as being relatively costly. Roboflow was selected because it allows for easier modification and versioning of a dataset and is free to use when assembling a public dataset. </span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span>During training, each yolov5 model was evaluated using Weights and Biases, otherwise known as wandb (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://wandb.ai/site&amp;sa=D&amp;source=editors&amp;ust=1650476739434349&amp;usg=AOvVaw0QEJAbFPFrnHslc6jpLR0C">wandb</a></span><span class="c1">). With wandb each training run is able to be easily compared on multiple metrics. Another particularly useful feature of wandb is the bounding box debugger. This allows images from the validation set to be compared at each step in the training process at multiple confidence thresholds. This enables models to be precisely evaluated to determine the types of mistakes it makes.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">At inference time we use several tools to deploy the yolov5 model and save the relevant data to the cloud. Our application pipeline is shown in the diagram below in two possible configurations.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 193.33px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 193.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span>Img sources: [</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://www.google.com/url?sa%3Di%26url%3Dhttps%253A%252F%252Fcommons.wikimedia.org%252Fwiki%252FFile%253AVideo_camera_icon.svg%26psig%3DAOvVaw1-SU0LOB6OSLTNj5FFyRKs%26ust%3D1649747586427000%26source%3Dimages%26cd%3Dvfe%26ved%3D0CAoQjRxqFwoTCLDLqeq6i_cCFQAAAAAdAAAAABAD&amp;sa=D&amp;source=editors&amp;ust=1650476739435211&amp;usg=AOvVaw11CGmajRhLbBAIekGLzktf">resort cam</a></span><span>, </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://pytorch.org/hub/ultralytics_yolov5/&amp;sa=D&amp;source=editors&amp;ust=1650476739435479&amp;usg=AOvVaw2uKbpvxUBg8bImJo8eTObU">yolov5</a></span><span>, </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://www.nvidia.com/en-us/about-nvidia/legal-info/logo-brand-usage/&amp;sa=D&amp;source=editors&amp;ust=1650476739435754&amp;usg=AOvVaw0c3p9hXZ4YkPkSheaGlUpb">jetson nano</a></span><span>, </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://mqtt.org/&amp;sa=D&amp;source=editors&amp;ust=1650476739435975&amp;usg=AOvVaw3yImBDTs4LFgPNfgL7dNhK">mqtt</a></span><span>, </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Amazon_Elastic_Compute_Cloud%23/media/File:AWS_Simple_Icons_Compute_Amazon_EC2_Instances.svg&amp;sa=D&amp;source=editors&amp;ust=1650476739436326&amp;usg=AOvVaw1xX5zyeOy6CFPiqBqtoPMX">ec2</a></span><span>, </span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://devblog.xero.com/amazon-s3-with-asp-net-core-2-0-cece44c77cf1?gi%3D48a041903a52&amp;sa=D&amp;source=editors&amp;ust=1650476739436676&amp;usg=AOvVaw1HGSJxcqO5c8ne-emugTAa">s3</a></span><span class="c1">]</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span>The use case we envision for this project would be deployed on an edge device at a ski resort. To simulate this, we used a jetston nano 2gb as our edge device (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://www.nvidia.com/en-us/autonomous-machines/embedded-systems/jetson-nano/education-projects/&amp;sa=D&amp;source=editors&amp;ust=1650476739437217&amp;usg=AOvVaw0xFz38AUxZIuy569eDraxe">jetson nano</a></span><span class="c1">). The yolov5 model runs on this jetson edge device which evaluates a video feed using a USB camera as the input source. As the yolov5 model generates predictions they are saved as a .csv file locally on the Jetson device.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">In the first configuration we make the assumption that the cameras that the model is running on have an ethernet connection to the network. In this context, we are able to write our .csv file directly to an s3 bucket using the boto3 python package. This is the simplest configuration, and we believe to be the most realistic since it would be hard to imagine all trail cameras on a large ski resort transmitting over a wifi network.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">In the second configuration, we assume that our edge devices are transmitting over an unreliable network connection. In this context we would propose using MQTT as a messaging service to upload the data to an s3 bucket. The jetson device would send the .csv file as a message using MQTT to an EC2 instance in AWS. The messaging quality of service (QoS) that would be used in MQTT is &lsquo;1&rsquo; which means the message is sent at least once, giving the highest chance for message delivery. We chose this QoS in this context because we are assuming that network coverage on a ski resort may be intermittent. In the EC2 instance we process the file by saving each csv file into an S3 bucket with a timestamp as the filename.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">Our current application operates on the infrastructure described in configuration one. We believe that this is more realistic, and it is much simpler to deploy.</span></p><h1 class="c5" id="h.h338del1qivt"><span class="c2">Model Design</span></h1><p class="c0"><span>We decided to architect the solution around the YOLOv5 framework given its success in modeling custom classes within image data (</span><span class="c4"><a class="c6" href="https://www.google.com/url?q=https://github.com/ultralytics/yolov5&amp;sa=D&amp;source=editors&amp;ust=1650476739438421&amp;usg=AOvVaw2GneYtszKTGwa6O-KP9Oe8">YOLOv5</a></span><span class="c1">). Since we were using RoboFlow to create bounding boxes and preprocess the image dataset, we were easily able to download the processed images via the RoboFlow API, formatted properly for YOLOv5. </span></p><h1 class="c5" id="h.434fvnkqqphc"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 337.45px; height: 510.50px;"><img alt="" src="images/image9.png" style="width: 337.45px; height: 510.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h1><p class="c0"><span class="c1">As discussed in our previous section, our model is training on images of skiers with helmet and no-helmet classifications. We additionally marked certain irrelevant pictures as null. Below, we see that non-skiing pictures and pictures without subjects in the foreground are excluded. This is to keep the training relevant to the skiing context and reduce error from mislabelling heads that were too far away to determine whether someone was wearing a helmet. This also kept our model from trying to overreach and predict on people that are too far away.</span></p><h1 class="c5" id="h.6qdp5u4rd228"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 624.00px;"><img alt="" src="images/image13.jpg" style="width: 624.00px; height: 624.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h1><p class="c0"><span class="c1">Because our model required strict labeling of helmets vs. hats/beanies/gaiters, we used images that were close enough to a face to make that distinction. This allowed us to use smaller image sizes when training the model. We ended up deciding on 416px images and training for 100 epochs.</span></p><p class="c0"><span>&nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 416.00px; height: 416.00px;"><img alt="" src="images/image6.jpg" style="width: 416.00px; height: 416.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">The training process completed in 3.119 hours and produced the results below. Based on our classification error scores, it looks like our model could benefit from more epochs to allow the model to better fit to our training data. We also see that our precision and recall are fairly close together. This means that our accuracy was fairly balanced between false positives and false negatives. For a simple monitoring solution this is probably fine, however if we were to implement this solution to fine skiers that aren&rsquo;t complying with safety rules, we may want to take greater care to increase the precision so we only fine people who are definitively not wearing helmets.</span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span>100 Epochs: &nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 312.00px;"><img alt="" src="images/image11.png" style="width: 624.00px; height: 312.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1">150 Epochs:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 312.00px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 312.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0 c3"><span class="c1"></span></p><p class="c11 c3"><span class="c1"></span></p><h1 class="c5" id="h.rrwa21ubbg2"><span class="c2">Challenges</span></h1><p class="c0"><span class="c1">The classifier had difficulty differentiating between helmets and other types of hats and beanies. This difficulty was exacerbated by images that were not head-on, as well as by google positioning. The outline of a helmet or hat was sometimes partially obscured in images where the rider had their goggles pulled up on top of their helmet or hat. </span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">The lower accuracy in images that are not head-on could lead to limitations in the positioning of the edge devices running the helmet detection system. Additionally, the frame is constrained by the Jetson. </span></p><p class="c0 c3"><span class="c1"></span></p><h1 class="c5" id="h.epj4mkz4wnxo"><span>Alternative Designs</span></h1><p class="c0"><span>A design decision that our group had to make early in the process was what to label. Our first thought was to teach the model what a helmet looks like, then train it to look for humans without a corresponding &ldquo;helmet&rdquo; label. This method might have been fruitful, but it wouldn&rsquo;t have told us anything about what it looks like to </span><span class="c8">not </span><span class="c1">wear a helmet. </span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">We also considered labeling only non-compliance. This would have achieved our goal of detecting individuals without helmets, but we worried that this approach might produce less usable data for ski resorts. Looking for only positive examples would make retraining on new examples more difficult. </span></p><p class="c3 c11"><span class="c1"></span></p><div><p class="c0 c3"><span class="c1"></span></p></div></body></html>